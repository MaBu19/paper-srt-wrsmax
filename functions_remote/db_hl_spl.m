function   ag_out = db_hl_spl(freq, ag, input_db)
% dB HL -> dB SPL: 0 dB HL corresponds to ... at different frequencies
offset = [125 45; ...
    250 25.5; ...
    500 11.5; ...
    1000 7; ...
    1500 6.5; ...
    2000 9; ...
    3000 10; ...
    4000 9.5; ...
    6000 15.5; ...
    8000 13];

% according to Roeser, Valente, Hosford-Dunn, eds. Audiology: Diagnosis, 2nd
% edition 2007, cited in
% Valente, Michael et al.: 2017 Audiology Answers for Otolaryngologists DOI: 10.1055/b-0038-149911

if strcmp(input_db,'HL') % transform to SPL
    for f = 1:size(ag,2)
        ag_out(:,f) = ag(:,f) + offset(offset(:,1)== freq(f),2);
    end
end

